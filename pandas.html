<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	<title></title>
	<meta name="generator" content="LibreOffice 7.4.7.2 (Linux)"/>
	<meta name="created" content="2023-06-16T14:21:19.175404707"/>
	<meta name="changed" content="2023-06-16T14:40:28.551839098"/>
	<style type="text/css">
		@page { size: 21cm 29.7cm; margin-left: 0.53cm; margin-right: 0.56cm; margin-top: 0.71cm; margin-bottom: 0.49cm }
		p { line-height: 115%; margin-bottom: 0.25cm; background: transparent }
		pre { font-family: "Liberation Mono", monospace; font-size: 10pt; background: transparent }
		h1 { margin-bottom: 0.21cm; background: transparent; page-break-after: avoid }
		h1.western { font-family: "Liberation Sans", sans-serif; font-size: 18pt; font-weight: bold }
		h1.cjk { font-family: "Source Han Sans CN"; font-size: 18pt; font-weight: bold }
		h1.ctl { font-family: "Droid Sans Devanagari"; font-size: 18pt; font-weight: bold }
		code { font-family: "Liberation Mono", monospace }
		a:link { color: #000080; text-decoration: underline }
		a:visited { color: #800000; text-decoration: underline }
	</style>
</head>
<body lang="ru-RU" link="#000080" vlink="#800000" dir="ltr"><h1 class="western" style="page-break-before: always">
<code>Pandas</code></h1>
<pre style="line-height: 100%">
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">import pandas as pd</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Создание DataFrame из списка словарей</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">data = [</font></code></font></font>
<code>    <font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><font size="3" style="font-size: 12pt">{'Name': 'John', 'Age': 30, 'City': 'New York'},</font></code></font></font>
<code>    <font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><font size="3" style="font-size: 12pt">{'Name': 'Alice', 'Age': 25, 'City': 'London'},</font></code></font></font>
<code>    <font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><font size="3" style="font-size: 12pt">{'Name': 'Bob', 'Age': 35, 'City': 'Paris'}</font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">]</font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">df = pd.DataFrame(data)</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Вывод первых нескольких строк DataFrame</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">print(df.head())</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Отбор данных по условию</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">filtered_df = df[df['Age'] &gt; 30]</font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">print(filtered_df)</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Группировка данных и вычисление агрегатных функций</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">grouped_df = df.groupby('City').mean()</font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">print(grouped_df)</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Сортировка данных по столбцу</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">sorted_df = df.sort_values('Age', ascending=False)</font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">print(sorted_df)</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Запись DataFrame в файл CSV</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">df.to_csv('data.csv', index=False)</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Чтение данных из файла CSV в DataFrame</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">new_df = pd.read_csv('data.csv')</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Изменение типа данных столбца</b></font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">new_df['Age'] = new_df['Age'].astype(float)</font></code></font></font>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt">print(new_df.dtypes)</font></code></font></font>

<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Выбор отдельных столбцов</b></font></code></font></font>
<code><font size="3" style="font-size: 12pt">name_column = df['Name']</font></code>
<code><font size="3" style="font-size: 12pt">print(name_column)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Добавление нового столбца</b></font></code>
<code><font size="3" style="font-size: 12pt">df['Salary'] = [5000, 6000, 4000]</font></code>
<code><font size="3" style="font-size: 12pt">print(df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Удаление столбца</b></font></code>
<code><font size="3" style="font-size: 12pt">df = df.drop('Salary', axis=1)</font></code>
<code><font size="3" style="font-size: 12pt">print(df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Применение функции к каждому элементу столбца</b></font></code>
<code><font size="3" style="font-size: 12pt">df['Age'] = df['Age'].apply(lambda x: x + 1)</font></code>
<code><font size="3" style="font-size: 12pt">print(df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Объединение DataFrame по ключу</b></font></code>
<code><font size="3" style="font-size: 12pt">data1 = {'Name': ['John', 'Alice'], 'Age': [30, 25]}</font></code>
<code><font size="3" style="font-size: 12pt">data2 = {'Name': ['Bob'], 'Age': [35]}</font></code>
<code><font size="3" style="font-size: 12pt">df1 = pd.DataFrame(data1)</font></code>
<code><font size="3" style="font-size: 12pt">df2 = pd.DataFrame(data2)</font></code>
<code><font size="3" style="font-size: 12pt">merged_df = pd.concat([df1, df2])</font></code>
<code><font size="3" style="font-size: 12pt">print(merged_df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Объединение DataFrame по индексу</b></font></code>
<code><font size="3" style="font-size: 12pt">df3 = pd.DataFrame({'Salary': [5000, 6000]}, index=[0, 1])</font></code>
<code><font size="3" style="font-size: 12pt">merged_df2 = pd.concat([df1, df3], axis=1)</font></code>
<code><font size="3" style="font-size: 12pt">print(merged_df2)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Объединение DataFrame по ключу или индексу</b></font></code>
<code><font size="3" style="font-size: 12pt">df4 = pd.DataFrame({'City': ['New York', 'London', 'Paris']})</font></code>
<code><font size="3" style="font-size: 12pt">merged_df3 = pd.merge(df1, df4, left_index=True, right_index=True)</font></code>
<code><font size="3" style="font-size: 12pt">print(merged_df3)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Объединение DataFrame по ключу или индексу с помощью SQL-подобного синтаксиса</b></font></code>
<code><font size="3" style="font-size: 12pt">merged_df4 = pd.merge(df1, df4, on='City')</font></code>
<code><font size="3" style="font-size: 12pt">print(merged_df4)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Применение агрегатных функций к группам данных</b></font></code>
<code><font size="3" style="font-size: 12pt">grouped_df2 = df.groupby('City').agg({'Age': 'mean', 'Salary': 'sum'})</font></code>
<code><font size="3" style="font-size: 12pt">print(grouped_df2)</font></code>
<font face="Liberation Mono, monospace"><font size="2" style="font-size: 10pt"><code><font size="3" style="font-size: 12pt"><b># Сортировка DataFrame по столбцу</b></font></code></font></font>
<code><font size="3" style="font-size: 12pt">sorted_df = df.sort_values(by='Age')</font></code>
<code><font size="3" style="font-size: 12pt">print(sorted_df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Запись DataFrame в CSV-файл</b></font></code>
<code><font size="3" style="font-size: 12pt">df.to_csv('data.csv', index=False)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Чтение данных из CSV-файла</b></font></code>
<code><font size="3" style="font-size: 12pt">new_df = pd.read_csv('data.csv')</font></code>
<code><font size="3" style="font-size: 12pt">print(new_df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Запись DataFrame в Excel-файл</b></font></code>
<code><font size="3" style="font-size: 12pt">df.to_excel('data.xlsx', index=False, sheet_name='Sheet1')</font></code>

<code><font size="3" style="font-size: 12pt"><b># Чтение данных из Excel-файла</b></font></code>
<code><font size="3" style="font-size: 12pt">new_df = pd.read_excel('data.xlsx', sheet_name='Sheet1')</font></code>
<code><font size="3" style="font-size: 12pt">print(new_df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Переименование столбцов</b></font></code>
<code><font size="3" style="font-size: 12pt">df = df.rename(columns={'Age': 'Years'})</font></code>
<code><font size="3" style="font-size: 12pt">print(df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Преобразование столбца в тип данных datetime</b></font></code>
<code><font size="3" style="font-size: 12pt">df['Date'] = pd.to_datetime(df['Date'])</font></code>
<code><font size="3" style="font-size: 12pt">print(df.dtypes)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Заполнение пропущенных значений</b></font></code>
<code><font size="3" style="font-size: 12pt">df = df.fillna(0)</font></code>
<code><font size="3" style="font-size: 12pt">print(df)</font></code>

<code><font size="3" style="font-size: 12pt"><b># Удаление строк с пропущенными значениями</b></font></code>
<code><font size="3" style="font-size: 12pt">df = df.dropna()</font></code>
<code><font size="3" style="font-size: 12pt"><span style="font-weight: normal">print(df)</span></font></code></pre>
</body>
</html>